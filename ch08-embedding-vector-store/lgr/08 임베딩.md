# 08 임베딩

날짜: 2025년 10월 28일

## 8.1 임베딩이란

텍스트나 이미지 같은 데이터를 부동 소수점 숫자로 이루어진 벡터로 변환하는 과정

강아지를 벡터화 시키고 애완견을 벡터화 시키면 유사도 검색에서 나오게 된다.

rdb에서 강아지를 검색하면 “개” 검색 안됨

벡터화하는 이유?

유사한 벡터를 찾기 위해

수학적으로 유사하다?

## 8.2 벡터 저장소

벡터 저장소: 벡터 값을 저장한다.

벡터 유사도 검색을 수행하는 유형의 데이터 베이스

벡터간 수치 계산 방법

1. L2거리 

![image.png](image.png)

1. 코사인 유사도 기반 거리
    - 두 벡터가 이루는 각도를 이용
    - 0 ≤ cos()≤2

![image.png](image%201.png)

### 벡터 저장소에 저장하는 과정

임베딩 모델을 통해서 벡터화한다. 유사도 검색을 해서 검색결과를 찾는다.

유사도 검색!= 정확한 검사

PGVector : 벡터 저장소 

postgresSQL를 위한 

![image.png](image%202.png)

-d : 백그라운드에서 사용한다

-p: 포트번호

-v: 데이터를 저장해서 다음에 실행시켰을때 이전 데이터를 받아올수 있도록한다.

명령어 파워쉘

```java
docker run `
--name pgvector `
-d `
-p 5432:5432 `
-e POSTGRES_USER=postgres `
-e POSTGRES_PASSWORD=postgres `
-v pgdata:/var/lib/postgresql/data `
pgvector/pgvector:pg17
```

` 백틱: 띄어서 입력한다. 

![image.png](image%203.png)

ada-002가 기본

output : text를 주는데 벡터화된 상태로 출력이 된다.

![image.png](image%204.png)

차원:  1536 

차원이 클수록? 뭐가 좋지?

- 유사성 검사를 하기 쉽다.  정밀해진다.

차원이 작으면? 

- 유사도 검사에서 성능이 안 좋다.

Miracl: 다국어 검색 성능을 평가한 점수

MTEB: 다양한 작업에서 종합적으로 평가

3-small을 사용한다.

```java
## PGVector
spring.datasource.url=jdbc:postgresql://localhost:5432/postgres
spring.datasource.username=postgres
spring.datasource.password=postgres
spring.ai.vectorstore.pgvector.initialize-schema=true
# spring.ai.vectorstore.pgvector.schema-name=public
 계정이랑 상관없이 schema 이름 public에 만들겠다.
# spring.ai.vectorstore.pgvector.table-name=vector_store
자동으로 vector_store 이름으로 만들어진다.
# spring.ai.vectorstore.pgvector.dimensions=1536
임베딩 모델이 만들어내는 벡터 차원 사이즈와 컬럼의 사이즈가 같아야한다.
```

  <script src="[https://cdn.jsdelivr.net/npm/marked/marked.min.js](https://cdn.jsdelivr.net/npm/marked/marked.min.js)"></script>

![image.png](image%205.png)