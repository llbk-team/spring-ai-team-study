# 음성 변환 기술

## 개요

| 단계 | 기술 | 설명 |
|------|------|------|
| STT | Speech to Text | 음성을 텍스트로 변환 |
| LLM | Chat Model | 텍스트를 이해하고 답변 생성 |
| TTS | Text to Speech | 텍스트를 음성으로 변환 |

---

## STT (Speech to Text)
- `OpenAiAudioTranscriptionModel` 사용  
- 오디오 파일(`Resource`)을 입력받아 텍스트 반환  
- `AudioTranscriptionOptions`로 모델(`whisper-1`)과 언어(`ko`) 설정 가능

---

## TTS (Text to Speech)
- `OpenAiAudioSpeechModel` 사용  
- 텍스트를 입력받아 음성(`byte[]`) 출력  
- `SpeechPrompt`로 모델, 음성 종류, 속도, 포맷 설정  
- `stream()`을 사용하면 실시간 스트리밍(Flux<byte[]>) 재생 가능

---

## STT → LLM → TTS 통합 처리
1. **STT** : 음성을 텍스트로 변환  
2. **LLM** : 텍스트를 AI 모델로 처리해 답변 생성  
3. **TTS** : 생성된 텍스트를 음성으로 변환

`Flux<byte[]>` 형태로 청크 단위 스트리밍 응답을 반환
`OutputStream`을 통해 순차적으로 전송 가능.

---

## 순수 음성 대화 (GPT-4o-mini Audio)
- 하나의 모델이 STT, LLM, TTS를 모두 수행  
- `GPT_4_O_AUDIO_PREVIEW` 모델 사용  
- 입력 음성과 텍스트를 함께 전달 (`UserMessage + Media`)  
- 출력 형식: 텍스트 + 오디오(MP3)  
- `AssistantMessage`에서 음성 데이터 추출 후 응답

---

## 핵심 포인트

| 구분 | 설명 |
|------|------|
| STT | `whisper-1` 모델로 음성을 텍스트로 변환 |
| TTS | `gpt-4o-mini-tts` 모델로 텍스트를 음성으로 변환 |
| 통합 | STT → LLM → TTS 순서로 처리 |
| 스트리밍 | `Flux<byte[]>`로 실시간 음성 재생 |
| 단일 모델 | `GPT_4_O_AUDIO_PREVIEW`로 음성 입력과 출력 통합 처리 |